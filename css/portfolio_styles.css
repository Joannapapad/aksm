<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="assets/aksm_logo.png">
    <meta name="description" content="Explore AKSM's portfolio, showcasing our expertise in surveying, scan2bim and UAV mapping. Discover a range of completed projects, from buildings, towers, malls to cultural centers, reflecting our commitment to quality, safety, and innovation.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <link rel="stylesheet" href="css/portfolio_styles.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" ></script>
    <script src="nav.js" defer></script>

    <style>
     /* Styles for the tabs */
.featured_projects .text-blk.tab {
  font-size: 20px;
  line-height: 10.1px;
  display: flex;
  align-items: center;
  color: #999999;
  font-weight: 500;
  margin-bottom: 2vh;
  cursor: pointer;
  text-align: center;
}

/* Active state styles for main tabs */
.tab-active {
  color: #817C76; /* Example active color */
  border-bottom: 2px solid #817C76; /* Active indicator for main tabs */
  width: auto;
}

/* Styles for the subtabs */
.featured_projects .dropdown-content p {
  color: #999999; /* Default color for subtabs */
  text-align: center;
}

/* Active state styles for subtabs */
.subtab.tab-active {
  color: #817C76; /* Example active color for active subtab */
  border-bottom: none; /* No border for active subtabs */
}

/* Remove border for all subtabs */
.dropdown-content p {
  border-bottom: none; /* Ensure no border for subtabs */
  font-size: 1.1em;
  padding: 15px;

}

/* Hover effect for subtabs */
.dropdown-content p:hover {
  background-color: #d4d1d1; /* Change background color on hover */
}
/* Styles for dropdown content */
.dropdown-content {
    display: none; /* Default to hidden */
    position: absolute;
    background-color: #f3f3f3;
    min-width: 200px;
    z-index: 1;
    
}

/* Always show dropdown content on small screens */
@media (max-width: 1300px) {
    .dropdown-content {
        display: block; /* Show dropdown by default */
        position: static; /* Change position to static to avoid overlapping issues */
        margin-top: 10px; /* Add some spacing if needed */
    }

    .dropdown {
        position: relative; /* Keep position relative for proper stacking */
    }

    /* Ensure tabs are stacked correctly */
    .tabs {
        flex-direction: column; /* Change to column direction for small screens */
    }

    /* Optionally, you might want to add some spacing between tabs */
    .tab {
        margin-bottom: 10px; /* Space between tabs */
    }
}

    </style>
</head>
<body>
    <div id="menu-container"></div>

    <div class="center_esp">
        <a href="https://www.aksm.gr/wp-content/uploads/2023/12/aksm_antagonistikotita_webEN.pdf" target="_blank">
            <img src="assets/espa.webp" class="logo_espa" alt="espa banner">
        </a>
    </div>

    <script>
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('menu-container').innerHTML = data;

                const script = document.createElement('script');
                script.src = 'nav.js';
                document.body.appendChild(script);
            });

        window.addEventListener('load', () => {
            document.body.classList.add('loaded');
        });
    </script>

    <a href="index.html">
        <img src="assets/aksm_logo.png" class="logo_header" alt="AKSM Logo">
    </a>

    <div class="featured_projects" unique-script-id="w-w-dm-id">
        <div class="container-block bg">
            <div class="heading-container">
                <h1 class="head">Portfolio</h1>
                <div class="animated-line-container2">
                    <div class="animated-line2"></div>
                </div>
                <p>Aksm has contributed to a variety of projects</p>
            </div>

            <div class="responsive-container-block opt-cont">
                <div class="menu_maker">
                    <div class="tabs">
                        <p class="text-blk tab tab-active" data-filter="all">All</p>
                        <p class="text-blk tab" data-filter="scan2bim">SCAN2BIM</p>

                        <!-- Dropdown Menu -->
                        <div class="dropdown">
                            <p class="text-blk tab" data-filter="const_ind_surv">CONSTRUCTION & INDUSTRIAL SURVEYING</p>
                            <div class="dropdown-content">
                                <p class="subtab" data-filter="ongoing">Ongoing Projects</p>
                                <p class="subtab" data-filter="finished">Completed Projects</p>
                            </div>
                        </div>

                        <p class="text-blk tab" data-filter="deformation_monitoring">DEFORMATION MONITORING</p>
                        <p class="text-blk tab" data-filter="uav_mapping">UAV MAPPING</p>
                    </div>
                </div>
            </div>

            <div class="responsive-container-block content" id="portfolio-container">
                <!-- Project content will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <div id="footer__cont"></div>

<script>
    fetch('footer.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('footer__cont').innerHTML = data;
        });
    
        function initializeHoverAndTabFunctionality(projects) {
    const $portfolioContainer = $("[unique-script-id='w-w-dm-id']");
    const $allLinks = $portfolioContainer.find(".link-wrapper");

    // Hide description and overlay initially
    $portfolioContainer.find(".img .desc").hide();
    $portfolioContainer.find(".img .overlay").hide();

    // Hover effects for project images
    $portfolioContainer.find(".img").hover(
        function () {
            $(this).find('.overlay, .desc').fadeIn();
        },
        function () {
            $(this).find('.overlay, .desc').fadeOut();
        }
    );

    // Main tab click handling
    $portfolioContainer.find(".tab").click(function () {
        const value = $(this).attr('data-filter');

        // Remove active state from all tabs
        $portfolioContainer.find(".tab").removeClass('tab-active');
        $portfolioContainer.find(".subtab").removeClass('tab-active'); // Reset subtab active state
        $(this).addClass('tab-active'); // Set active state for clicked tab

        // Hide all projects initially
        $allLinks.hide();

        // Show projects based on selected tab
        if (value === 'all') {
            $allLinks.show(500);
        } else {
            // Show projects matching the clicked tab's filter
            $allLinks.filter(`.${value}`).show(500);
        }

        // Hide dropdown content if any subtab or another tab is clicked
        $portfolioContainer.find('.dropdown-content').hide();
    });

    // Subtab click handling for dropdown
    $portfolioContainer.find(".subtab").click(function (event) {
        event.stopPropagation(); // Prevent the event from bubbling up to the parent elements
        const selectedValue = $(this).attr('data-filter');
        const status = selectedValue === 'ongoing' ? 'ongoing' : 'finished';

        // Set the active state for the clicked subtab
        $portfolioContainer.find(".subtab").removeClass('tab-active');
        $(this).addClass('tab-active');

        // Ensure parent dropdown tab is still highlighted
        $portfolioContainer.find(".tab[data-filter='const_ind_surv']").addClass('tab-active');

        $allLinks.hide(); // Hide all links initially

        // Show projects based on status (ongoing/finished) and type (const_ind_surv)
        $allLinks.each(function () {
            const projectId = $(this).attr('id');
            const projectData = projects.find(item => item.id === projectId);
            // Ensure that the project is of type const_ind_surv
            if (projectData && projectData.status === status && projectData.typeofproject2 === 'const_ind_surv') {
                $(this).show(500); // Show the matching projects
            }
        });

        // Hide the dropdown content after selection
        $portfolioContainer.find('.dropdown-content').hide();
    });

    // Open the dropdown when hovering over the parent tab
    $portfolioContainer.find('.dropdown').hover(
        function () {
            $(this).find('.dropdown-content').show();
        },
        function () {
            $(this).find('.dropdown-content').hide();
        }
    );

    // Click event for touch devices to toggle dropdown visibility
    $portfolioContainer.find('.dropdown > .tab').click(function (event) {
        event.stopPropagation(); // Prevent the event from bubbling up to the parent elements
        $(this).siblings('.dropdown-content').toggle(); // Toggle the dropdown content visibility
    });

    // Close dropdown if clicked outside
    $(document).click(function () {
        $portfolioContainer.find('.dropdown-content').hide(); // Hide dropdown when clicking outside
    });
}



        fetch('project.json')
        .then(response => response.json())
        .then(projects => {
            const container = $('#portfolio-container');

            // Generate project HTML and append it to the container
            projects.forEach(project => {
                const projectHTML = `
                    <a href="project_details.html?id=${project.id}" class="link-wrapper ${project.typeofproject2}" id="${project.id}">
                        <div class="responsive-container-block img ${project.typeofproject2}">
                            <img class="im image-block" src="${project.image_front}">
                            <div class="responsive-container-block overlay overlay-visible"></div>
                            <div class="responsive-container-block desc">
                                <p class="text-blk title">${project.title}, ${project.location}</p>
                                <p class="text-blk info">Completed Project ${project.completionyear} <br>${project.typeofproject.toUpperCase()}</p>
                            </div>
                        </div>
                    </a>`;
                container.append(projectHTML);
            });

            // Initialize hover and tab functionality after projects are loaded
            initializeHoverAndTabFunctionality(projects);
        });

    
</script>

</body>
</html>
