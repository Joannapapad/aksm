<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="assets/aksm_logo.png">
    <meta name="description" content="Explore AKSM's portfolio, showcasing our expertise in surveying, scan2bim and UAV mapping. Discover a range of completed projects, from buildings, towers, malls to cultural centers, reflecting our commitment to quality, safety, and innovation.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <link rel="stylesheet" href="css/portfolio_styles.css">
    <script src="nav.js" defer></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    
</head>
<body>
    <div id="menu-container"></div>

    <div class="center_esp">
        <a href="https://www.aksm.gr/wp-content/uploads/2023/12/aksm_antagonistikotita_webEN.pdf" target="_blank">
            <img src="assets/espa.webp" class="logo_espa" alt="espa banner">
        </a>
    </div>

    <script>
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('menu-container').innerHTML = data;
                // Removed dynamic loading of nav.js
            })
            .catch(error => {
                console.error('Error fetching header:', error);
            });

        window.addEventListener('load', () => {
            document.body.classList.add('loaded');
        });
    </script>

    <a href="index.html">
        <img src="assets/aksm_logo.png" class="logo_header" alt="AKSM Logo">
    </a>

    <div class="featured_projects" unique-script-id="w-w-dm-id">
        <div class="container-block bg">
            <div class="heading-container">
                <h1 class="head">Portfolio</h1>
                <div class="animated-line-container2">
                    <div class="animated-line2"></div>
                </div>
                <p>Aksm has contributed to a variety of projects</p>
            </div>

        <div class="responsive-container-block opt-cont">
            <div class="menu_maker">
                <div class="tabs">
                    <p class="text-blk tab tab-active" data-filter="all">All</p>
                    <p class="text-blk tab" data-filter="scan2bim">SCAN2BIM</p>
                    <p class="text-blk tab" data-filter="const_ind_surv">CONSTRUCTION & INDUSTRIAL SURVEYING</p>
                    <p class="text-blk tab" data-filter="deformation_monitoring">DEFORMATION MONITORING</p>
                    <p class="text-blk tab" data-filter="uav_mapping">UAV MAPPING</p>
                </div>
                
                <!-- Dropdown Filter on the side -->
                <div class="filter-dropdown">
                    <label for="project-status">Filter by:</label>
                    <select id="project-status">
                        <option value="all">All Projects</option>
                        <option value="ongoing">Ongoing Projects</option>
                        <option value="finished">Finished Projects</option>
                    </select>
                </div>
            </div>
        </div>

            <div class="responsive-container-block content" id="portfolio-container">
                <!-- Project content will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <div id="footer__cont"></div>

    <script>
        // Fetch and insert the footer
        fetch('footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer__cont').innerHTML = data;
            })
            .catch(error => {
                console.error('Error fetching footer:', error);
            });

function generateProjectHTML(project) {
    let projectClass = project.typeofproject2;

    // Determine the subcategory class based on the project's status
    if (project.status === 'ongoing') {
        projectClass += ' ongoing'; // Add status class directly
    } else if (project.status === 'finished') {
        projectClass += ' finished'; // Add status class directly
    }

    return `
        <a href="project_details.html?id=${project.id}" class="link-wrapper ${projectClass}">
            <div class="responsive-container-block img ${projectClass}" id="${project.id}">
                <img class="im image-block" src="${project.image_front}" alt="${project.title}">
                <div class="responsive-container-block overlay overlay-visible"></div>
                <div class="responsive-container-block desc">
                    <p class="text-blk title">${project.title}, ${project.location}</p>
                    <p class="text-blk info">
                        ${project.status === 'ongoing' ? 'Ongoing Project' : 'Completed in: ' + project.completionyear}
                        <br>${project.typeofproject.toUpperCase()}
                    </p>
                </div>
            </div>
        </a>
    `;
}



        // Fetch and display projects
        fetch('project.json')
            .then(response => response.json())
            .then(projects => {
                const container = document.getElementById('portfolio-container');

                // Insert projects into the DOM
                projects.forEach(project => {
                    container.innerHTML += generateProjectHTML(project);
                });

                // Initialize hover and tab functionality
                initializeHoverAndTabFunctionality();
            })
            .catch(error => {
                console.error('Error fetching projects:', error);
            });
        
function initializeHoverAndTabFunctionality() {
    const $portfolioContainer = $("[unique-script-id='w-w-dm-id']");
    const $allLinks = $portfolioContainer.find(".link-wrapper");
    const $tabs = $portfolioContainer.find(".tab");

    // Hide description and overlay initially
    $portfolioContainer.find(".img .desc, .img .overlay").hide();

    // Hover effects
    $portfolioContainer.find(".img").hover(
        function () {
            $(this).find('.overlay, .desc').stop(true, true).fadeIn(200);
        },
        function () {
            $(this).find('.overlay, .desc').stop(true, true).fadeOut(200);
        }
    );

    // Filter projects based on active tab and dropdown
    function filterProjects() {
        const activeTab = $tabs.filter('.tab-active').attr('data-filter');
        const selectedValue = $('#project-status').val();

        $allLinks.hide(500); // Hide all initially

        let filterClass = '';

        // Check for "All" tab
        if (activeTab === 'all') {
            filterClass = ''; // Show all projects if "All" is selected
        } else {
            filterClass = `.${activeTab}`; // Filter by the active tab
        }

        // Append the status filter based on dropdown selection
        if (selectedValue === 'ongoing') {
            filterClass += '.ongoing'; // Add ongoing status filter
        } else if (selectedValue === 'finished') {
            filterClass += '.finished'; // Add finished status filter
        }

        // If no filter class is set, show all projects
        if (filterClass === '') {
            $allLinks.show(500); // Show all projects if no filter is applied
        } else {
            $allLinks.filter(filterClass).show(500); // Show filtered projects
        }
    }

    // Handle main tab clicks
    $tabs.click(function () {
        $tabs.removeClass('tab-active');
        $(this).addClass('tab-active');
        filterProjects(); // Filter when tab changes
    });

    // Filter based on dropdown selection
    $('#project-status').change(function () {
        filterProjects(); // Filter when dropdown changes
    });

    // Set default tab and load projects on page load
    $tabs.filter('[data-filter="all"]').addClass('tab-active');
    filterProjects(); // Call filter on page load
}

// Call the function to initialize functionality
$(document).ready(function () {
    initializeHoverAndTabFunctionality();
});

    </script>
</body>
</html>
